{% extends "base-fluid.j2" %}
{% from "macros.j2" import find_value %}

{% block title %}Entry{% endblock %}

{% block content %}

<h1>Entry</h1>

<div class="row">
  <div class="col-md-4">
    <form method="post">
      <div>
        <div class="mb-3">
          <label for="race">Race</label>
          <input type="text" class="form-control" disabled value="{{ entry.race }}">
        </div>
        <div class="mb-3">
          <label for="race">Category</label>
          <select class="form-select" class="form-control" id="category" name="category">
            {% for category in categories %}
            <option value="{{ category }}" {% if (entry.category==category) %} selected{% endif %}>{{ category }}
            </option>
            {% endfor %}
          </select>
        </div>
        <div class="mb-3">
          <label for="division">Division</label>
          <input type="number" class="form-control" disabled
            value="{{ find_value(request.form['division'], entry.division) }}">
        </div>
        <div class="mb-3">
          <label for="division">Team</label>
          <input type="text" class="form-control" disabled value="{{ entry.team if entry.team else '' }}">
        </div>
        <div>
          <label for="division">Services</label>
          <input type="checkbox" disabled{% if entry.services %} checked{% endif %} style="float: right;">
        </div>
      </div>
      <hr class="my-4">
      <button type="submit" class="btn btn-primary">Update</button>
    </form>
  </div>
  <div class="col-md-8">
    <h3>Notes</h3>
    <ul>
      <li>An entry is only considered to be <em>services</em> if all paddlers in the boat are <em>services</em>.</li>
    </ul>
  </div>
</div>
<div class="row">
  <div class="col-md-12">
    <div class="table-responsive">
      <table class="table table-striped table-sm">
        <thead>
          <tr>
            <th scope="col">Paddler</th>
            <th scope="col">Club</th>
            <th scope="col">Division</th>
            <th scope="col">Team</th>
            <th scope="col" class="services">Services</th>
            <th scope="col">Paid</th>
            <th scope="col"></th>
          </tr>
        </thead>
        <tbody>
          {% for seat in entry.seats %}
          <tr>
            <td><a href="{{ url_for('kanoe.paddler', paddler_id=seat.paddler.id) }}">{{ seat.paddler.name }}</a></td>
            <td><a href="{{ url_for('kanoe.club', club_id=seat.club.id) }}">{{ seat.club.id }}</a></td>
            <td>{{ seat.paddler.division }}</td>
            <td>{{ seat.team or "" }}</td>
            <td class="services">{% if seat.services %}<i class="fas fa-check"></i>{% endif %}</td>
            <td>{{ "Â£ %.2f"|format(seat.paid) }}</td>
            <td><a href="{{ url_for('kanoe.seat', seat_id=seat.id) }}"><i class="fas fa-edit"></i></a></td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %}

{% block sidebar %}
{% include 'sidebar-entry.j2' %}
{% endblock %}